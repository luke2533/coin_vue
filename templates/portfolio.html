{% extends "base.html" %}
{% block content %}

    <section>

<!-- Portfolio Desktop -->

        <div class="containter-fluid">
            <div class="row justify-content-center portfolio-desktop">
                <div class="col-11">
                    <div class="accordion" id="accordionExample">
                        <div class="card portoflio-body">
                            <div class="card-header portfolio-card" id="headingOne">
                                <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#portfolio-chart" aria-expanded="true" aria-controls="portfolio-chart">
                                    <div class="row">
                                        <div class="col-10 portfolio-title">
                                            <h2>{{ username.capitalize() }}'s Portfolio</h2>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-6 portfolio-title">
                                            <h3>${{ total_value }}</h3>
                                        </div>
                                    </div>
                                        
                                </button>
                                </h2>
                            </div>
                        
                            <div id="portfolio-chart" class="collapse" aria-labelledby="My Portfolio" data-parent="#portfolio-chart">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6 portfolio-title">
                                            <h4>${{ total_profit }} 24h</h4>
                                        </div>

                                        <div class="col-6 text-right">                                           
                                            <!-- Button trigger modal -->
                                            <button type="button" class="user-button" data-toggle="modal" data-target="#transaction-modal">
                                                + Add New
                                            </button>
                                    
                                            <!-- Transaction Modal -->
                                            <div class="modal fade" id="transaction-modal" tabindex="-1" aria-labelledby="transaction" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="transaction">Add Transaction</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: #FFAC5E;">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            
                                                            <div class="row justify-content-center" style="margin-top: 10px;">
                                                                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab active" id="buy-tab" data-toggle="pill" href="#buy" role="tab" aria-controls="buy-tab" aria-selected="true">Buy</a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab" id="sell-tab" data-toggle="pill" href="#sell" role="tab" aria-controls="sell-tab" aria-selected="false">Sell</a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab" id="staking-tab" data-toggle="pill" href="#staking" role="tab" aria-controls="staking-tab" aria-selected="false">Staking</a>
                                                                    </li> 
                                                                      
                                                                </ul>
                                                            </div>
                                                            
                                                            <div class="tab-content" id="pills-tabContent">
                                                                
                                                                <!-- BUY -->
                                                                <div class="tab-pane fade show active" id="buy" role="tabpanel" aria-labelledby="buy-tab">
                                                                        
                                                                    <form method="POST" action="{{ url_for('add_record') }}">
                                                                        <div class="row justify-content-center">               
                                                                            <div class="text-box">                                                    
                                                                                <p style="text-align: left;">To record your buy order select the correct coin and enter the quantity, price per token and date of the transaction</p>                                                                           
                                                                            </div>
                                                                        </div>
                                                                            
                                                                        <div class="row justify-content-center">
                                                                            <div class="form-group">                                          
                                                                                <select class="form-control record" id="coin_id" name="coin_id">
                                                                                    <option disabled selected>Select Coin</option>                                                                 
                                                                                {% for obj in names %}                                                                
                                                                                    <option>{{ obj.name }}</option>                                                                 
                                                                                {% endfor %}
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    <!-- Change each option out for a single one that automatcically adds them -->
                                                                              
                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>                  
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" required>
                                                                        </div>
                                                                                <!-- User crypto record form -->
        
                                                                        <div class="row justify-content-center">                                                               
                                                                            <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <input type="text" class="record" id="notes" name="notes" placeholder="Notes">
                                                                        </div>
                                                                    <!-- Users can add the date of purchase and add notes -->
                                                                        <input type="hidden" class="record" id="total" name="total" placeholder="$0.00" readonly>

                                                                
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                            <button type="submit" class="user-button" name="type" value="Buy">Add Transaction</button>
                                                                        </div>
                                                                    </form>
                                                                </div>

                                                                <!-- SELL -->
                                                                <div class="tab-pane fade" id="sell" role="tabpanel" aria-labelledby="sell-tab">

                                                                    <form method="POST" action="{{ url_for('add_record') }}">
                                                                        <div class="row justify-content-center">
                                                                            <div class="text-box">
                                                                                <p style="text-align: left;">To record your Sell order select the correct coin and enter the quantity, price per token and date of the transaction</p>
                                                                            </div>                                                                            
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <div class="form-group">                                          
                                                                                <select class="form-control record" id="coin_id" name="coin_id">
                                                                                    <option disabled selected>Select Coin</option>                                                                 
                                                                                {% for obj in names %}                                                                
                                                                                    <option>{{ obj.name }}</option>                                                                 
                                                                                {% endfor %}
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    <!-- Change each option out for a single one that automatcically adds them -->
                                                                    
                                                                        <div class="row justify-content-center">                                         
                                                                            <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>
                                                                        </div>

                                                                        <div class="row justify-content-center">                                                                           
                                                                            <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" required>                                                                           
                                                                        </div>
                                                                    <!-- User crypto record form -->
        
                                                                        <div class="row justify-content-center">                                                                                                  
                                                                            <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                        </div>

                                                                        <div class="row justify-content-center">                                                                                                  
                                                                            <input type="text" class="record" id="notes" name="notes" placeholder="Notes">
                                                                        </div>
                                                                    <!-- Users can add the date of purchase and add notes -->
                                                                        <input type="hidden" class="record" id="total" name="total" placeholder="$0.00" readonly>
                                                                
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                            <button type="submit" class="user-button" name="type" value="Sell">Add Transaction</button>
                                                                        </div>
                                                                    </form>
                                                                </div>

                                                                <!-- STAKING -->
                                                                <div class="tab-pane fade" id="staking" role="tabpanel" aria-labelledby="staking-tab">

                                                                    
                                                                        <form method="POST" action="{{ url_for('add_record') }}">
                                                                            <div class="row justify-content-center">
                                                                                <div class="text-box">
                                                                                    <p style="text-align: left;">To record your Staking rewards enter the coin, quantity and date. Earn passive income on your crypto</p>
                                                                                </div>                                                                            
                                                                            </div>
                                                                            
                                                                            <div class="row justify-content-center"> 
                                                                                <div class="form-group">                                          
                                                                                    <select class="form-control record" id="coin_id" name="coin_id">
                                                                                        <option disabled selected>Select Coin</option>                                                                 
                                                                                    {% for obj in names %}                                                                
                                                                                        <option>{{ obj.name }}</option>                                                                 
                                                                                    {% endfor %}
                                                                                    </select>                                                                                   
                                                                                </div>
                                                                            </div>
                                                                               <!-- Change each option out for a single one that automatcically adds them -->                                                                          

                                                                            <div class="row justify-content-center">                                                                             
                                                                                    <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>
                                                                                    <input type="hidden" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" value="0">                                                                                  
                                                                            </div>
                                                                            <!-- User crypto record form -->
                
                                                                            <div class="row justify-content-center">                                                                                                                               
                                                                                <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                            </div>
                                                                                    
                                                                            <div class="row justify-content-center">    
                                                                                <input type="text" class="record" id="notes" name="notes" placeholder="Notes">  
                                                                            </div>
                                                                            <!-- Users can add the date of purchase and add notes -->
                                                                        
                                                                            <input type="hidden" class="record" id="total" name="total" value="0" placeholder="$0.00">

                                                                            <div class="modal-footer">
                                                                                <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                                <button type="submit" class="user-button" name="type" value="Staking">Add Transaction</button>
                                                                            </div>
                                                                        </form>
                                                                
                                                                </div>

                                                                
                                                            </div>
                                                            <!-- https://getbootstrap.com/docs/4.5/components/navs/#tab TabPills -->

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<!-- Portfolio Desktop -->

<!-- Portfolio Mobile -->

        <div class="containter-fluid">
            <div class="row justify-content-center portfolio-mobile">
                <div class="col-12">
                    <div class="accordion" id="accordionExample">
                        <div class="card portoflio-body">
                            <div class="card-header portfolio-card" id="headingOne">
                                <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#portfolio-chart" aria-expanded="true" aria-controls="portfolio-chart">
                                    <div class="row">
                                        <div class="col-12 portfolio-title">
                                            <h3>{{ username.capitalize() }}'s Portfolio</h3>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-10 portfolio-title">
                                            <h4>$7318.09</h4>
                                        </div>
                                    </div>
                                        
                                </button>
                                </h2>
                            </div>
                        
                            <div id="portfolio-chart" class="collapse" aria-labelledby="My Portfolio" data-parent="#portfolio-chart">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-5 portfolio-title profit-mobile">
                                            <h5>-$129.10 24h</h5>
                                        </div>

                                        <div class="col-7 text-right profit-mobile">
                                            <!-- Button trigger modal -->
                                            <button type="button" class="user-button" data-toggle="modal" data-target="#transaction-modal-mobile">
                                                + Add New
                                            </button>
                                    
                                            <!-- Transaction Modal Mobile -->
                                            <div class="modal fade" id="transaction-modal-mobile" tabindex="-1" aria-labelledby="record" aria-hidden="true">
                                                <div class="modal-dialog modal-sm">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="record">Add Transaction</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        
                                                        <div class="modal-body">
                                                            
                                                            <div class="row justify-content-center">
                                                                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab active" id="buy-tab" data-toggle="pill" href="#buy-mobile" role="tab" aria-controls="buy-tab" aria-selected="true">Buy</a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab" id="sell-tab" data-toggle="pill" href="#sell-mobile" role="tab" aria-controls="sell-tab" aria-selected="false">Sell</a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link record-tab" id="staking-tab" data-toggle="pill" href="#staking-mobile" role="tab" aria-controls="staking-tab" aria-selected="false">Staking</a>
                                                                    </li> 
                                                                      
                                                                </ul>
                                                            </div>
                                                            
                                                            <div class="tab-content" id="pills-tabContent">
                                                                
                                                                <!-- BUY -->
                                                                <div class="tab-pane fade show active" id="buy-mobile" role="tabpanel" aria-labelledby="buy-tab">
                                                                        
                                                                    <form method="POST" action="{{ url_for('add_record') }}">

                                                                        <div class="row justify-content-center">               
                                                                            <div class="text-box">                                                    
                                                                                <p style="text-align: left;">To record your buy order select the correct coin and enter the quantity, price per token and date of the transaction</p>                                                                           
                                                                            </div>
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <div class="form-group">                                          
                                                                                <select class="form-control record" id="coin_id" name="coin_id">
                                                                                    <option disabled selected>Select Coin</option>                                                                 
                                                                                {% for obj in names %}                                                                
                                                                                    <option>{{ obj.name }}</option>                                                                 
                                                                                {% endfor %}
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    <!-- Change each option out for a single one that automatcically adds them -->
                                                                              
                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>   
                                                                        </div>
                                                                        
                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" required>
                                                                        </div>
                                                                    <!-- User crypto record form -->
        
                                                                        <div class="row justify-content-center">                                                               
                                                                            <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                        </div>
                                                                        
                                                                        <div class="row justify-content-center">                                                               
                                                                            <input type="text" class="record" id="notes" name="notes" placeholder="Notes">
                                                                        </div>
                                                                    <!-- Users can add the date of purchase and add notes -->

                                                                        <input type="hidden" class="record" id="total" name="total" placeholder="$0.00" readonly>
                                                                        
                                                                
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                            <button type="submit" class="user-button" name="type" value="Buy">Add Transaction</button>
                                                                        </div>
                                                                    </form>
                                                                </div>

                                                                <!-- SELL -->
                                                                <div class="tab-pane fade" id="sell-mobile" role="tabpanel" aria-labelledby="sell-tab">

                                                                    <form method="POST" action="{{ url_for('add_record') }}">

                                                                        <div class="row justify-content-center">
                                                                            <div class="text-box">
                                                                                <p style="text-align: left;">To record your Sell order select the correct coin and enter the quantity, price per token and date of the transaction</p>
                                                                            </div>                                                                            
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <div class="form-group">                                          
                                                                                <select class="form-control record" id="coin_id" name="coin_id">
                                                                                    <option disabled selected>Select Coin</option>                                                                 
                                                                                {% for obj in names %}                                                                
                                                                                    <option>{{ obj.name }}</option>                                                                 
                                                                                {% endfor %}
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    <!-- Change each option out for a single one that automatcically adds them -->
                                                                    
                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                            <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" required>
                                                                        </div>
                                                                    <!-- User crypto record form -->
        
                                                                        <div class="row justify-content-center">                                                               
                                                                            <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                        </div>

                                                                        <div class="row justify-content-center">                                                              
                                                                            <input type="text" class="record" id="notes" name="notes" placeholder="Notes">    
                                                                        </div>
                                                                    <!-- Users can add the date of purchase and add notes -->
        
                                                                        <input type="hidden" class="record" id="total" name="total" placeholder="$0.00" readonly>
                                                                
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                            <button type="submit" class="user-button" name="type" value="Sell">Add Transaction</button>
                                                                        </div>
                                                                    </form>
                                                                </div>

                                                                <!-- STAKING -->
                                                                <div class="tab-pane fade" id="staking-mobile" role="tabpanel" aria-labelledby="staking-tab">

                                                                    
                                                                    <form method="POST" action="{{ url_for('add_record') }}">
                                                                        
                                                                        <div class="row justify-content-center">
                                                                            <div class="text-box">
                                                                                <p style="text-align: left;">To record your Staking rewards enter the coin, quantity and date. Earn passive income on your crypto</p>
                                                                            </div>                                                                            
                                                                        </div>

                                                                        <div class="row justify-content-center">
                                                                               
                                                                            <div class="form-group">                                          
                                                                                <select class="form-control record" id="coin_id" name="coin_id">
                                                                                    <option disabled selected>Select Coin</option>                                                                 
                                                                                {% for obj in names %}                                                                
                                                                                    <option>{{ obj.name }}</option>                                                                 
                                                                                {% endfor %}
                                                                                </select>                                                                                   
                                                                            </div>
                                                                           <!-- Change each option out for a single one that automatcically adds them -->                                                                          

                                                                            <div class="row justify-content-center">
                                                                                <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>
                                                                                <input type="hidden" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" value="0">
                                                                            </div>
                                                                            <!-- User crypto record form -->
                
                                                                            <div class="row justify-content-center">                                                               
                                                                                <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                            </div>

                                                                            <div class="row justify-content-center">                                                               
                                                                                <input type="text" class="record" id="notes" name="notes" placeholder="Notes">
                                                                            </div>
                                                                            <!-- Users can add the date of purchase and add notes -->
                                                                        
                                                                            <input type="hidden" class="record" id="total" name="total" value="0" placeholder="$0.00">
                                                                                
                                                                        </div>

                                                                        <div class="modal-footer">
                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                            <button type="submit" class="user-button" name="type" value="Staking">Add Transaction</button>
                                                                        </div>
                                                                    </form>                                                            
                                                                </div>                                                              
                                                            </div>
                                                            <!-- https://getbootstrap.com/docs/4.5/components/navs/#tab TabPills -->
                                                        </div>                          
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<!-- Portfolio Mobile -->

    </section>

    <section>
        <!-- THIS IS WHERE STEP 2 READ -->

        <!-- Portfolio Holdings Desktop -->

        <div class="container-fluid">
            <div class="row justify-content-center holdings-desktop">
                <div class="col-10">
                    <table class="table table-striped portfolio-table">
                        <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Price</th>
                                <!-- CoinMarketCap listing latest crypto current price -->
                                <th scope="col">24h %</th>
                                <!-- CoinMarketCap listing latest 24 hour % change -->
                                <th scope="col">Holdings</th>
                                <!-- Mongo DB Quantity + Quaintiy = Holdings -->
                                <th scope="col">Value</th>
                                <!-- CoinMarketCap price * Quantity (Holdings) -->
                                <th scope="col">Profit/Loss</th>
                                <!-- NOT displayed total + total = GrandTotal -->
                                <!-- Value - GrandTotal == Profit/Loss -->
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for record in portfolios %}
                                {% for obj in prices %}
                                    <tr>
                                        <td>{{ record.coin_id}}</td>
                                        <td>{{ obj.quote.USD.price }}</td>
                                        <td>{{ obj.quote.USD.percent_change_24h }}</td>
                                        <td>{{ record.holdings}}</td>
                                        <td>{{ record.value }}</td>
                                        <td>{{ record.profit_loss }}</td>
                                        <td>
                                            <button type="button" class="action-button" data-toggle="modal" data-target="#record-modal"><i class="fas fa-ellipsis-v"></i></button>
                                            
                                            <div class="modal fade" id="record-modal" tabindex="-1" aria-labelledby="record" aria-hidden="true">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="record">{{ username.capitalize() }}'s records</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="row justify-content-center">
                                                                <table>
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Record ID</th>
                                                                            <th>Coin Name</th>
                                                                            <th>Type</th>
                                                                            <th>Price</th>
                                                                            <th>Quantity</th>
                                                                            <th>Total</th>
                                                                            <th>Date</th>
                                                                            <th>Notes</th>
                                                                            <th>Actions</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        {% for obj in user_record %}
                                                                            <tr>                                
                                                                                <td>{{ obj._id }}</td>
                                                                                <td>{{ obj.coin_id }}</td>
                                                                                <td>{{ obj.type }}</td>
                                                                                <td>{{ obj.per_coin }}</td>
                                                                                <td>{{ obj.quantity }}</td>
                                                                                <td>{{ obj.total }}</td>
                                                                                <td>{{ obj.date }}</td>
                                                                                <td>{{ obj.notes }}</td>
                                                                                <td>
                                                                                    <button type="button" class="action-button" data-toggle="modal" data-target="#edit-modal"><i class="fas fa-edit"></i></button>
                                                                                    <!-- Button trigger modal -->
                                                                                    
                                                                                    <!-- Edit Modal  -->
                                                                                    <div class="modal fade" id="edit-modal" tabindex="-1" aria-labelledby="edit" aria-hidden="true">
                                                                                        <div class="modal-dialog modal-dialog-centered">
                                                                                            <div class="modal-content">
                                                                                                <div class="modal-header">
                                                                                                    <h5 class="modal-title" id="edit">Edit Transaction</h5>
                                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                                        <span aria-hidden="true">&times;</span>
                                                                                                    </button>
                                                                                                </div>
                                                                                                <div class="modal-body">
                                                                                                    
                                                                                                    <!-- EDIT -->
                                                                                                    <form method="POST" action="{{ url_for('edit_record') }}">

                                                                                                        <div class="row justify-content-center">
                                                                                                            <div class="text-box">
                                                                                                                <p style="text-align: center;">If you have made a mistake recording your transaction change to correct details here</p>
                                                                                                            </div>                                                                            
                                                                                                        </div>
                                                                                                            
                                                                                                        <div class="row justify-content-center">
                                                                                                            <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity_edit" required>
                                                                                                        </div>
                                                                                                        <div class="row justify-content-center">
                                                                                                            <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin_edit" required>
                                                                                                        </div>
                                                                                                        
                                                                                                    <!-- User crypto record form -->
                                        
                                                                                                        <div class="row justify-content-center">                                                               
                                                                                                            <input type="date" class="record" id="date" name="date_edit" placeholder="Date" required>
                                                                                                        </div>

                                                                                                        <div class="row justify-content-center">                                                               
                                                                                                            <input type="text" class="record" id="notes" name="notes_edit" placeholder="Notes">
                                                                                                        </div>
                                                                                                        
                                                                                                    <!-- Users can add the date of purchase and add notes -->
                                                                                                        <input type="hidden" class="record" id="total" name="total_edit" placeholder="$0.00" readonly> 
                                                                                                
                                                                                                        <div class="modal-footer">
                                                                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                                                            <button type="submit" class="user-button" name="type" value="Edit">Edit Transaction</button>
                                                                                                        </div>
                                                                                                    </form>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>                                              
                                                                                        <!-- Button trigger modal -->
                                                                                    <button type="button" class="action-button" data-toggle="modal" data-target="#delete-record">
                                                                                        <i class="far fa-trash-alt"></i>
                                                                                    </button>
                                                                                    
                                                                                    <!-- Modal -->
                                                                                    <div class="modal fade" id="delete-record" tabindex="-1" aria-labelledby="delete-record" aria-hidden="true">
                                                                                        <div class="modal-dialog">
                                                                                            <div class="modal-content">
                                                                                                <div class="modal-header">
                                                                                                    <h5 class="modal-title" id="delete-record">Delete record</h5>
                                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                                        <span aria-hidden="true">&times;</span>
                                                                                                    </button>
                                                                                                </div>
                                                                                                <div class="modal-body">
                                                                                                    <div class="text-box">
                                                                                                        <p>
                                                                                                            Are you sure you want to delete this record?
                                                                                                            <br>
                                                                                                            This action cannot be undone.
                                                                                                        </p>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <form method="POST" action="{{ url_for('delete_record') }}">
                                                                                                    <div class="modal-footer">
                                                                                                        <button type="button" class="user-button" data-dismiss="modal">Cancel</button>
                                                                                                        <button type="submit" class="user-button">Yes delete</button>
                                                                                                    </div>
                                                                                                </form>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                            </tr>                          
                                                                        {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                            <button type="button" class="user-button">Save changes</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Button trigger modal -->
                                            <button type="button" class="action-button" data-toggle="modal" data-target="#delete-coin">
                                                <i class="far fa-trash-alt"></i>
                                            </button>
                                            
                                            <!-- Delete All records Modal Destkop -->
                                            <div class="modal fade" id="delete-coin" tabindex="-1" aria-labelledby="delete-coin" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="delete-coin">Delete all records</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="text-box">
                                                                <p>
                                                                    Are you sure you want to delete all records of this coin?
                                                                    <br>
                                                                    This action cannot be undone.
                                                                </p>
                                                            </div>   
                                                        </div>
                                                        <form method="POST" action="{{ url_for('delete_all_coin') }}">
                                                            <div class="modal-footer">
                                                                <button type="button" class="user-button" data-dismiss="modal">Cancel</button>
                                                                <button type="submit" class="user-button">Yes delete</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            {% endfor %}
                            
                        </tbody>
                    </table>       
                </div>
            </div>
        </div>
        <!-- Will need to work out how to only show user spesfic records that share the same username -->

        <!-- Portfolio Holdings Desktop -->

        <!-- Portfolio Holdings Mobile -->

        <div class="container-fluid">
            <div class="row justify-content-center holdings-mobile">
                <div class="col-12">
                    <table class="table table-striped portfolio-table">
                        <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Price</th>
                                <th scope="col">24h %</th>
                                <th scope="col">Holdings</th>
                                <th scope="col">Value</th>
                                <th scope="col">Profit</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- {,% for portfolio in my_portfolios %,} -->
                                {% for obj in prices %}
                                    <tr>
                                        <td></td>
                                        <td>{{ obj.quote.USD.price }}</td>
                                        <td>{{ obj.quote.USD.percent_change_24h }}</td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td>
                                            <button type="button" class="action-button" data-toggle="modal" data-target="#record-modal-mobile"><i class="fas fa-ellipsis-v"></i></button>
                                            <!-- ADD THE RECORD MODAL HERE -->
                                            <div class="modal fade" id="record-modal-mobile" tabindex="-1" aria-labelledby="record" aria-hidden="true">
                                                <div class="modal-dialog modal-md">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="record">(THE COINS NAME)</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="row justify-content-center holdings-mobile">
                                                                <div class="col-12">
                                                                    <table>
                                                                        <thead>
                                                                            <tr>
                                                                                <th>Type</th>
                                                                                <th>Price</th>
                                                                                <th>Quantity</th>
                                                                                <th>Total</th>
                                                                                <th>Date</th>
                                                                                <th>Notes</th>
                                                                                <th>Actions</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for obj in user_record %}
                                                                                <tr>                    
                                                                                    <td>{{ obj.username }}</td>                     
                                                                                    <td>{{ obj.coin_id }}</td>
                                                                                    <!-- Above is just for testing remove username and coin_id -->
                                                                                    <td>{{ obj.type }}</td>
                                                                                    <td>{{ obj.per_coin }}</td>
                                                                                    <td>{{ obj.quantity }}</td>
                                                                                    <td>{{ obj.total }}</td>
                                                                                    <td>{{ obj.date }}</td>
                                                                                    <td>{{ obj.notes }}</td>
                                                                                    <td>
                                                                                        <button type="button" class="action-button" data-toggle="modal" data-target="#edit-mobile"><i class="fas fa-edit"></i></button>
                                                                                    <!-- Button trigger modal -->
                                                                                    
                                                                                        <!-- Edit Modal Mobile  -->
                                                                                        <div class="modal fade" id="edit-mobile" tabindex="-1" aria-labelledby="edit" aria-hidden="true">
                                                                                            <div class="modal-dialog modal-dialog-centered">
                                                                                                <div class="modal-content">
                                                                                                    <div class="modal-header">
                                                                                                        <h5 class="modal-title" id="edit">Edit Transaction</h5>
                                                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                                            <span aria-hidden="true">&times;</span>
                                                                                                        </button>
                                                                                                    </div>
                                                                                                    <div class="modal-body">
                                                                                                        
                                                                                                        <!-- EDIT -->
                                                                                                        <form method="POST" action="{{ url_for('edit_record') }}">
                                                                                                                
                                                                                                            <div class="row justify-content-center">
                                                                                                                <div class="text-box">
                                                                                                                    <p style="text-align: center;">If you have made a mistake recording your transaction change to correct details here</p>
                                                                                                                </div>                                                                            
                                                                                                            </div>

                                                                                                            <div class="row justify-content-center">
                                                                                                                <input type="text" placeholder="Quantity" class="record" id="quantity" name="quantity" required>
                                                                                                            </div>
                                                                                                               
                                                                                                            <div class="row justify-content-center">
                                                                                                                <input type="text" placeholder="Price Per Coin" class="record" id="per_coin" name="per_coin" required>                                                                                                            
                                                                                                            </div>
                                                                                                        <!-- User crypto record form -->
                                            
                                                                                                            <div class="row justify-content-center">                                                                                                                 
                                                                                                                <input type="date" class="record" id="date" name="date" placeholder="Date" required>
                                                                                                            </div>
                                                                                                            
                                                                                                            <div class="row justify-content-center">             
                                                                                                                <input type="text" class="record" id="notes" name="notes" placeholder="Notes">
                                                                                                            </div>
                                                                                                        <!-- Users can add the date of purchase and add notes -->
                                            
                                                                                                            <input type="hidden" class="record" id="total" name="total" placeholder="$0.00" readonly>
                                                                                                    
                                                                                                            <div class="modal-footer">
                                                                                                                <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                                                                                <button type="submit" class="user-button" name="type" value="Edit">Edit Transaction???</button>
                                                                                                            </div>
                                                                                                        </form>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                                <!-- Button trigger modal -->
                                                                                        <button type="button" class="action-button" data-toggle="modal" data-target="#delete-record">
                                                                                            <i class="far fa-trash-alt"></i>
                                                                                        </button>
                                                                                        
                                                                                        <!-- Delete Record Modal Mobile -->
                                                                                        <div class="modal fade" id="delete-record" tabindex="-1" aria-labelledby="delete-record" aria-hidden="true">
                                                                                            <div class="modal-dialog">
                                                                                                <div class="modal-content">
                                                                                                    <div class="modal-header">
                                                                                                        <h5 class="modal-title" id="delete-record">Delete record</h5>
                                                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                                            <span aria-hidden="true">&times;</span>
                                                                                                        </button>
                                                                                                    </div>
                                                                                                    <div class="modal-body">
                                                                                                        <div class="text-box">
                                                                                                            <p>
                                                                                                                Are you sure you want to delete this record?
                                                                                                                <br>
                                                                                                                This action cannot be undone.
                                                                                                            </p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <form method="POST" action="{{ url_for('delete_record') }}">
                                                                                                        <div class="modal-footer">
                                                                                                            <button type="button" class="user-button" data-dismiss="modal">Cancel</button>
                                                                                                            <button type="submit" class="user-button">Yes delete</button>
                                                                                                        </div>
                                                                                                    </form>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>                                                                            
                                                                                </tr>
                                                                            {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="user-button" data-dismiss="modal">Close</button>
                                                            <button type="button" class="user-button">Save changes</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Button trigger modal -->
                                            <button type="button" class="action-button" data-toggle="modal" data-target="#delete-coin">
                                                <i class="far fa-trash-alt"></i>
                                            </button>
                                            
                                            <!-- Delete All records Modal Movile -->
                                            <div class="modal fade" id="delete-coin" tabindex="-1" aria-labelledby="delete-coin" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="delete-coin">Delete all records</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="text-box">
                                                                <p>
                                                                    Are you sure you want to delete all records of this coin?
                                                                    <br>
                                                                    This action cannot be undone.
                                                                </p>
                                                            </div>   
                                                        </div>
                                                        <form method="POST" action="{{ url_for('delete_all_coin') }}">
                                                            <div class="modal-footer">
                                                                <button type="button" class="user-button" data-dismiss="modal">Cancel</button>
                                                                <button type="submit" class="user-button">Yes delete</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            <!-- {,% endfor %,} -->
                            
                        </tbody>
                    </table>       
                </div>
            </div>
        </div>

        <!-- Portfolio Holdings Mobile -->

    </section>


{% endblock %}